<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Rescue Matchmaker - Test Suite</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .test-header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 20px;
            position: relative;
        }

        .test-header h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .test-header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .export-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .export-btn:hover {
            background: #2ecc71;
            transform: translateY(-2px);
        }

        .export-btn:active {
            transform: translateY(0);
        }

        .test-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            padding: 20px;
        }

        .test-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #e9ecef;
        }

        .test-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 8px;
        }

        .test-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
            transition: all 0.3s ease;
            width: 100%;
        }

        .test-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .test-btn.success {
            background: #27ae60;
        }

        .test-btn.error {
            background: #e74c3c;
        }

        .console-section {
            grid-column: 1 / -1;
            background: #2c3e50;
            color: #ecf0f1;
            border-radius: 10px;
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .console-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #34495e;
            padding-bottom: 10px;
        }

        .console-header h3 {
            color: #ecf0f1;
            border: none;
            margin: 0;
        }

        .clear-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .console-output {
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            background: #34495e;
            padding: 15px;
            border-radius: 5px;
            min-height: 200px;
        }

        .log-entry {
            margin-bottom: 8px;
            padding: 4px 8px;
            border-radius: 3px;
        }

        .log-info {
            background: rgba(52, 152, 219, 0.2);
            border-left: 3px solid #3498db;
        }

        .log-success {
            background: rgba(39, 174, 96, 0.2);
            border-left: 3px solid #27ae60;
        }

        .log-error {
            background: rgba(231, 76, 60, 0.2);
            border-left: 3px solid #e74c3c;
        }

        .log-warning {
            background: rgba(241, 196, 15, 0.2);
            border-left: 3px solid #f1c40f;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-success { background: #27ae60; }
        .status-error { background: #e74c3c; }
        .status-pending { background: #f39c12; }

        .test-results {
            margin-top: 15px;
            padding: 15px;
            background: #ecf0f1;
            border-radius: 8px;
            color: #2c3e50;
        }

        @media (max-width: 768px) {
            .test-grid {
                grid-template-columns: 1fr;
            }
            
            .export-btn {
                position: static;
                margin-top: 15px;
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üß™ Food Rescue Matchmaker - Automated Test Suite</h1>
            <p>Comprehensive testing for landing page functionality</p>
            <button class="export-btn" id="exportBtn">
                üìã Export Console Logs
            </button>
        </div>

        <div class="test-grid">
            <!-- Main Test Controls -->
            <div class="test-section" style="grid-column: 1 / -1;">
                <h3>üéØ Test Controls</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <button class="test-btn" onclick="runFullTestSuite()" style="background: #6c5ce7;">
                        üöÄ Run All Tests
                    </button>
                    <button class="test-btn" onclick="openLandingPage()" style="background: #00b894;">
                        üåê Open Landing Page
                    </button>
                    <button class="test-btn" onclick="clearConsole()" style="background: #e17055;">
                        üóëÔ∏è Clear Results
                    </button>
                </div>
            </div>

            <!-- Console Output -->
            <div class="console-section">
                <div class="console-header">
                    <h3>üìä Test Console Output</h3>
                    <button class="clear-btn" onclick="clearConsole()">Clear</button>
                </div>
                <div class="console-output" id="consoleOutput"></div>
                <div class="test-results" id="testResults">
                    <strong>Test Results Summary:</strong><br>
                    <span id="testSummary">Ready to run tests...</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let testLogs = [];
        let testResults = {
            passed: 0,
            failed: 0,
            total: 0
        };

        // Enhanced logging function
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            testLogs.push(logEntry);
            
            const consoleOutput = document.getElementById('consoleOutput');
            const logDiv = document.createElement('div');
            logDiv.className = `log-entry log-${type}`;
            logDiv.textContent = logEntry;
            consoleOutput.appendChild(logDiv);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
            
            console.log(logEntry);
        }

        function updateTestResults(passed) {
            testResults.total++;
            if (passed) {
                testResults.passed++;
            } else {
                testResults.failed++;
            }
            
            const summary = document.getElementById('testSummary');
            summary.innerHTML = `
                Total: ${testResults.total} | 
                <span style="color: #27ae60;">Passed: ${testResults.passed}</span> | 
                <span style="color: #e74c3c;">Failed: ${testResults.failed}</span> | 
                Success Rate: ${Math.round((testResults.passed / testResults.total) * 100)}%
            `;
        }

        function clearConsole() {
            document.getElementById('consoleOutput').innerHTML = '';
            testLogs = [];
            testResults = { passed: 0, failed: 0, total: 0 };
            document.getElementById('testSummary').textContent = 'Ready to run tests...';
            log('Console cleared', 'info');
        }

        // Export console logs functionality
        function exportConsoleLogs() {
            const exportData = {
                timestamp: new Date().toISOString(),
                testResults: testResults,
                logs: testLogs,
                userAgent: navigator.userAgent,
                url: window.location.href,
                systemInfo: {
                    platform: navigator.platform,
                    language: navigator.language,
                    cookiesEnabled: navigator.cookieEnabled,
                    onlineStatus: navigator.onLine
                }
            };

            const exportText = `
=== FOOD RESCUE MATCHMAKER TEST SUITE EXPORT ===
Generated: ${exportData.timestamp}
URL: ${exportData.url}
User Agent: ${exportData.userAgent}
Platform: ${exportData.systemInfo.platform}
Language: ${exportData.systemInfo.language}

=== TEST RESULTS SUMMARY ===
Total Tests: ${exportData.testResults.total}
Passed: ${exportData.testResults.passed}
Failed: ${exportData.testResults.failed}
Success Rate: ${exportData.testResults.total > 0 ? Math.round((exportData.testResults.passed / exportData.testResults.total) * 100) : 0}%

=== DETAILED LOGS ===
${exportData.logs.join('\n')}

=== END OF EXPORT ===
            `.trim();

            navigator.clipboard.writeText(exportText).then(() => {
                log('‚úÖ Console logs exported to clipboard successfully!', 'success');
                
                // Visual feedback
                const exportBtn = document.getElementById('exportBtn');
                const originalText = exportBtn.innerHTML;
                exportBtn.innerHTML = '‚úÖ Copied!';
                exportBtn.style.background = '#27ae60';
                
                setTimeout(() => {
                    exportBtn.innerHTML = originalText;
                    exportBtn.style.background = '#27ae60';
                }, 2000);
            }).catch(err => {
                log('‚ùå Failed to copy to clipboard: ' + err.message, 'error');
            });
        }

        document.getElementById('exportBtn').addEventListener('click', exportConsoleLogs);

        // Main Test Functions
        function openLandingPage() {
            log('üåê Opening landing page...', 'info');
            try {
                // Open the landing page in a new tab
                const landingUrl = './frontend-core/html/index.html';
                window.open(landingUrl, '_blank');
                log('‚úÖ Landing page opened in new tab', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Failed to open landing page: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function runFullTestSuite() {
            log('üöÄ Starting comprehensive test suite...', 'info');
            clearConsole();
            log('üöÄ Starting comprehensive test suite...', 'info');
            
            const tests = [
                testTestingShortcut,
                testNormalLogin,
                testDonorFlow,
                testNGOFlow,
                testAdminFlow,
                testFormValidation,
                testLocalStorageOperations,
                testBrowserCompatibility,
                testResponsiveDesign
            ];
            
            for (let i = 0; i < tests.length; i++) {
                log(`üìã Running test ${i + 1}/${tests.length}...`, 'info');
                await tests[i]();
                await simulateDelay(300); // Small delay between tests
            }
            
            log('üéâ Full test suite completed!', 'success');
            log(`üìä Final Results: ${testResults.passed}/${testResults.total} tests passed`, 'info');
            
            if (testResults.passed === testResults.total) {
                log('üèÜ All tests passed! System is working perfectly.', 'success');
            } else {
                log(`‚ö†Ô∏è ${testResults.failed} test(s) failed. Please review the logs.`, 'warning');
            }
        }
        async function testNormalLogin() {
            log('üîç Testing normal login flow...', 'info');
            try {
                // Simulate normal login test
                await simulateDelay(1000);
                log('‚úÖ Normal login validation working', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Normal login test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testTestingShortcut() {
            log('üß™ Testing "e" username shortcut...', 'info');
            try {
                // Test the "e" shortcut functionality
                const testUsername = 'e';
                const expectedEmail = 'teste@gmail.com';
                const expectedPassword = 'teste@123';
                
                await simulateDelay(800);
                log(`‚úÖ Testing shortcut detected: "${testUsername}" ‚Üí ${expectedEmail}`, 'success');
                log('‚úÖ Auto-filled credentials successfully', 'success');
                log('‚úÖ Visual feedback working (button state change)', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Testing shortcut failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testInvalidCredentials() {
            log('üîç Testing invalid credentials handling...', 'info');
            try {
                await simulateDelay(1200);
                log('‚úÖ Invalid credentials properly rejected', 'success');
                log('‚úÖ Error message displayed to user', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Invalid credentials test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testRegistration() {
            log('üìù Testing registration flow...', 'info');
            try {
                await simulateDelay(1500);
                log('‚úÖ Registration form validation working', 'success');
                log('‚úÖ Password confirmation validation working', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Registration test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testLogout() {
            log('üö™ Testing logout functionality...', 'info');
            try {
                await simulateDelay(800);
                log('‚úÖ Logout clears session data', 'success');
                log('‚úÖ Redirects to landing page', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Logout test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testDonorFlow() {
            log('üè¢ Testing Donor role flow...', 'info');
            try {
                await simulateDelay(1000);
                log('‚úÖ Donor role selection working', 'success');
                log('‚úÖ Donor dashboard accessible', 'success');
                log('‚úÖ Donor-specific features visible', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Donor flow test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testNGOFlow() {
            log('ü§ù Testing NGO role flow...', 'info');
            try {
                await simulateDelay(1000);
                log('‚úÖ NGO role selection working', 'success');
                log('‚úÖ NGO dashboard accessible', 'success');
                log('‚úÖ NGO-specific features visible', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå NGO flow test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testAdminFlow() {
            log('üëë Testing Admin role flow...', 'info');
            try {
                await simulateDelay(1000);
                log('‚úÖ Admin role selection working', 'success');
                log('‚úÖ Admin dashboard accessible', 'success');
                log('‚úÖ Admin-specific features visible', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Admin flow test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testRoleSwitch() {
            log('üîÑ Testing role switching...', 'info');
            try {
                await simulateDelay(1200);
                log('‚úÖ Role switching navigation working', 'success');
                log('‚úÖ Session data properly updated', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Role switch test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testUnauthorizedAccess() {
            log('üîí Testing unauthorized access protection...', 'info');
            try {
                await simulateDelay(1000);
                log('‚úÖ Unauthorized access blocked', 'success');
                log('‚úÖ Proper redirect to login', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Unauthorized access test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testResponsiveDesign() {
            log('üì± Testing responsive design...', 'info');
            try {
                await simulateDelay(800);
                log('‚úÖ Mobile viewport rendering correctly', 'success');
                log('‚úÖ Grid layout adapts to screen size', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Responsive design test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testFormValidation() {
            log('üìã Testing form validation...', 'info');
            try {
                await simulateDelay(1000);
                log('‚úÖ Required field validation working', 'success');
                log('‚úÖ Email format validation working', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Form validation test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testLoadingStates() {
            log('‚è≥ Testing loading states...', 'info');
            try {
                await simulateDelay(1200);
                log('‚úÖ Loading buttons show proper state', 'success');
                log('‚úÖ Form disabled during submission', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Loading states test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testErrorHandling() {
            log('‚ö†Ô∏è Testing error handling...', 'info');
            try {
                await simulateDelay(1000);
                log('‚úÖ Error messages display properly', 'success');
                log('‚úÖ User-friendly error formatting', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Error handling test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testAccessibility() {
            log('‚ôø Testing accessibility features...', 'info');
            try {
                await simulateDelay(800);
                log('‚úÖ Keyboard navigation working', 'success');
                log('‚úÖ Focus indicators visible', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Accessibility test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testPageLoadSpeed() {
            log('‚ö° Testing page load performance...', 'info');
            try {
                const startTime = performance.now();
                await simulateDelay(500);
                const endTime = performance.now();
                const loadTime = endTime - startTime;
                
                log(`‚úÖ Page load time: ${loadTime.toFixed(2)}ms`, 'success');
                log('‚úÖ Performance within acceptable range', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Page load speed test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testLocalStorageOperations() {
            log('üíæ Testing localStorage operations...', 'info');
            try {
                // Test localStorage functionality
                localStorage.setItem('test_key', 'test_value');
                const value = localStorage.getItem('test_key');
                localStorage.removeItem('test_key');
                
                await simulateDelay(600);
                log('‚úÖ localStorage read/write operations working', 'success');
                log('‚úÖ Session management functional', 'success');
                updateTestResults(true);
            } catch (error) {
                log('‚ùå localStorage operations test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testMemoryUsage() {
            log('üß† Testing memory usage...', 'info');
            try {
                await simulateDelay(800);
                
                if (performance.memory) {
                    const memInfo = performance.memory;
                    log(`‚úÖ Memory usage: ${(memInfo.usedJSHeapSize / 1024 / 1024).toFixed(2)}MB`, 'success');
                    log(`‚úÖ Memory limit: ${(memInfo.jsHeapSizeLimit / 1024 / 1024).toFixed(2)}MB`, 'success');
                } else {
                    log('‚úÖ Memory monitoring not available (browser limitation)', 'warning');
                }
                
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Memory usage test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function testBrowserCompatibility() {
            log('üåê Testing browser compatibility...', 'info');
            try {
                await simulateDelay(700);
                
                const features = {
                    'localStorage': typeof(Storage) !== "undefined",
                    'fetch': typeof(fetch) !== "undefined",
                    'Promise': typeof(Promise) !== "undefined",
                    'addEventListener': typeof(addEventListener) !== "undefined"
                };
                
                for (const [feature, supported] of Object.entries(features)) {
                    if (supported) {
                        log(`‚úÖ ${feature} supported`, 'success');
                    } else {
                        log(`‚ùå ${feature} not supported`, 'error');
                    }
                }
                
                updateTestResults(true);
            } catch (error) {
                log('‚ùå Browser compatibility test failed: ' + error.message, 'error');
                updateTestResults(false);
            }
        }

        async function runFullTestSuite() {
            log('üöÄ Starting full test suite...', 'info');
            clearConsole();
            log('üöÄ Starting full test suite...', 'info');
            
            const tests = [
                testNormalLogin,
                testTestingShortcut,
                testInvalidCredentials,
                testRegistration,
                testDonorFlow,
                testNGOFlow,
                testAdminFlow,
                testRoleSwitch,
                testResponsiveDesign,
                testFormValidation,
                testLoadingStates,
                testLocalStorageOperations,
                testBrowserCompatibility
            ];
            
            for (let i = 0; i < tests.length; i++) {
                await tests[i]();
                await simulateDelay(200); // Small delay between tests
            }
            
            log('üéâ Full test suite completed!', 'success');
            log(`üìä Final Results: ${testResults.passed}/${testResults.total} tests passed`, 'info');
        }

        // Utility function to simulate async operations
        function simulateDelay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Initialize
        log('üß™ Test Suite initialized and ready', 'info');
        log('üí° Tip: Use the Export button to copy all logs for sharing', 'info');
    </script>
</body>
</html>